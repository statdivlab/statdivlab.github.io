<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	
<title>publications | Statistical Diversity Lab</title>
<meta name="description" lang="en-us" content="" />
<link rel="canon_test" href="publications.html">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	
<script src="javascripts/jquery-1.11.0.min.js%3F1391410894" type="text/javascript"></script> 
<script src="javascripts/jquery.simplemodal.1.4.4.min.js%3F1387826925" type="text/javascript"></script> 
<script src="javascripts/jquery-ui-1.10.3.custom.min.js%3F1388181381" type="text/javascript"></script> 


<script type="text/javascript">
  /*  patch added 9/18/2018 by scott
   *  fix issue of link editing when ckeditor is opened in lightbox mode
   *  https://bizango.teamwork.com/#/tasks/11559149
   */
  $.widget( "ui.dialog", $.ui.dialog, {
   /*! jQuery UI - v1.10.2 - 2013-12-12
    *  http://bugs.jqueryui.com/ticket/9087#comment:27 - bugfix
    *  http://bugs.jqueryui.com/ticket/4727#comment:23 - bugfix
    *  allowInteraction fix to accommodate windowed editors
    */
    _allowInteraction: function( event ) {
      if ( this._super( event ) ) {
        return true;
      }

      // address interaction issues with general iframes with the dialog
      if ( event.target.ownerDocument != this.document[ 0 ] ) {
        return true;
      }

      // address interaction issues with dialog window
      if ( $( event.target ).closest( ".cke_dialog" ).length ) {
        return true;
      }

      // address interaction issues with iframe based drop downs in IE
      if ( $( event.target ).closest( ".cke" ).length ) {
        return true;
      }
    },
   /*! jQuery UI - v1.10.2 - 2013-10-28
    *  http://dev.ckeditor.com/ticket/10269 - bugfix
    *  moveToTop fix to accommodate windowed editors
    */
    _moveToTop: function ( event, silent ) {
      if ( !event || !this.options.modal ) {
        this._super( event, silent );
      }
    }
  });
</script>
    

    

	<link href="https://fonts.googleapis.com/css?family=Exo+2:300,400,500,600,700" rel="stylesheet">
	<link href="stylesheets/blocks/defaults.css%3F1694197450.css" media="screen" rel="stylesheet" type="text/css" />
	<link href="stylesheets/sdi/site.css%3F1539372687.css" media="screen" rel="stylesheet" type="text/css" />

	</head>
<body id="body_publications" class=" body_nothome ">

	<div id="hero_frame" class="userBG tAr" >
	<div class="page_frame group">
		<a id="logo" href="index.html"></a>
		

		<div id="utility_nav">
			<img src="images/sites/sdi/headeremail.png" class="this">
			<a href="tel:206.543.8027"><span class="icon-phone"></span>206.543.8027</a>
			<a href="https://twitter.com/AmyDWillis" target="_BLANK" class="twitt"><span class="icon-twitter"></span></a>
			<a href="https://github.com/adw96" target="_BLANK" class="git"><span class="icon-github"></span></a>
		</div>
		<div id="nav_frame">
					<div id="nav">
			<ul class="nav">
				<li><a id="nav_publications" rel="publications"  href="publications.html">publications</a></li>
				<li><a id="nav_team" rel="team"  href="team.html">team</a></li>
				<li><a id="nav_software" rel="software"  href="software.html">software</a></li>
				<li><a id="nav_teaching" rel="teaching"  href="teaching.html">teaching</a></li>
				<li><a id="nav_blog" rel="blog"  href="blog.html">blog</a></li>
				<li><a id="nav_overview" rel="overview"  href="overview.html">research overview</a></li>
			</ul>
		</div>

		<div id="mobile_nav">
			<div class="icon">Menu &equiv;</div>
			<ul class="nav">
				<li><a id="nav_home" rel="home"  href="index.html">home</a></li>
				<li><a id="nav_publications" rel="publications"  href="publications.html">publications</a></li>
				<li><a id="nav_team" rel="team"  href="team.html">team</a></li>
				<li><a id="nav_software" rel="software"  href="software.html">software</a></li>
				<li><a id="nav_teaching" rel="teaching"  href="teaching.html">teaching</a></li>
				<li><a id="nav_blog" rel="blog"  href="blog.html">blog</a></li>
				<li><a id="nav_overview" rel="overview"  href="overview.html">research overview</a></li>
			</ul>
		</div>
	
			<div class="rule"></div>
		</div>
	</div>
</div>

		<div class="titlebar">
	<div class="page_frame">
		<div class="fourteen-col center tAc">
				<div class="bizango_cms bizango_cms_content bizango_content_prose textdiv_prose" id="content_151419_prose" data-bizango='{"monkey":"data", "field":"prose", "object_type":"content", "cms_id":"151419", "label":"" ,  "tag":"div"}' >	
		<h2>publications</h2>

<p><span style="color: rgb(155, 158, 144); font-size: 13px; letter-spacing: 1.2px; text-transform: uppercase;">STATISTICAL DIVERSITY LAB</span></p>
		
	</div>
	






		</div>
	</div>
</div>


  

<div data-sortable="151419">


	<div class="block_container " data-content-id="166534"> 
  <div class="block__bg-img block_container__bg-img" style="display:none;"></div>
	
	

    <script type="text/javascript" src="javascripts/sdi/priority-queue.js"></script>
<script type="text/javascript" src="javascripts/sdi/latex-to-unicode.js"></script>
<!-- <script type="text/javascript" src="/javascripts/sdi/bibtex_js.js"></script> -->
<div id="166534" class="block block_id-166534 block_type__bib-text-auto-sort">
	<div class="page_frame">

			<div class="twelve-col center">
				<table id="pubTable" class="display"></table>
					<div class="bibtex_input" style="display:none;">

            @article{cabrera2024distances,
              title={Distances between Extension Spaces of Phylogenetic Trees},
              author={Maria Alejandra Valdez Cabrera and Amy D Willis},
              year ={Preprints},
              journal = {arxiv},
              url = {https://arxiv.org/abs/2407.00227}, 
              pages = {2024+},
            }

@article{clausen2024estimating,
  title={Estimating Fold Changes from Partially Observed Outcomes with Applications in Microbial Metagenomics},
  author={David S Clausen and Amy D Willis},
  year ={Preprints},
  journal = {arxiv},
  url = {https://arxiv.org/abs/2402.05231},
  pages = {2024+},
}

@article{tinyvamp,
  author = {David S Clausen and Amy D Willis},
  year ={Preprints},
  title = {{Modeling complex measurement error in microbiome experiments}},
  journal = {arxiv},
  year ={Preprints},
  url = {https://arxiv.org/abs/2204.12733},
  pages = {2022+},
  }


@article{reiter,
author = {Taylor E Reiter, Luiz C Irber Jr, Alicia A Gingrich, Dylan Haynes, N Tessa Pierce-Ward, Phillip T Brooks, Yosuke Mizutani, Dominik Moritz, Felix Reidl, Amy D Willis, Blair D Sullivan and C Titus Brown},
year ={Preprints},
title = {{Meta-analysis of metagenomes via machine learning and assembly graphs reveals strain switches in Crohn&#x27;s disease}},
journal = {bioRxiv},
pages = {2022+},
url = {https://www.biorxiv.org/content/10.1101/2022.06.30.498290v1}
}


@article{implications,
author = {Michael R McLaren, Jacob T Nearing, Amy D Willis, Karen G Lloyd, Benjamin J Callahan},
year ={Preprints},
title = {{Implications of taxonomic bias for microbial differential-abundance analysis}},
journal = {biorXiv},
pages = {2024+},
url = {https://www.biorxiv.org/content/10.1101/2022.08.19.504330v2}
}
</div>


				<!-- The references will be populated in "bibtex_display" !-->
<div class="bibtex_display">   
</div>
<div class="bibtex_template">
	<div class ="well">
		<div class ="container">
			<div class="if author" style="font-weight: bold;">
				<span class="author"></span>
			</div>

			<!-- This div is what is used to determine what is displayed from the bib entry. It is written to produce (roughly) APA formatting, though it is not perfect... !-->
			<div style="margin-left: 10px; margin-bottom:5px;">
				<span class="if url">
          <a class="url "><span class="title "></span></a>.
				</span>
				<span class="if !url">
          <span class="title "></span>.
				</span>
				<span class="if editor ">
					In <span class="editor "></span> (Eds.),
				</span>
				<span class="if booktitle ">
					<span class="booktitle " style="font-style: italic;"></span>
					<span class="if pages ">
						(p. <span class="pages "></span>).
					</span>
					<span class="if address "><span class="address "></span>:</span>
					<span class="if publisher "><span class="publisher "></span>.</span>
				</span>
				<span class="if journal " style="font-style: italic;">
					<span class="journal"></span>,
				</span>
				<span class="if volume " style="font-style: italic;">
					<span class="volume"></span>
				</span>
				<span class="if number ">
					(<span class="number "></span>),
				</span>
				<span class="if journal ">
					<span class="if pages ">
						<span class="pages "></span>.
					</span>
				</span>
			</div>

		</div>
	</div>
</div>
					
			</div>




 
	</div>
</div>

<script type="text/javascript">
$(document).ready(function() {
// Issues:
//  no comment handling within strings
//  no string concatenation
//  no variable values yet

// Grammar implemented here:
//  bibtex -> (string | preamble | comment | entry)*;
//  string -> '@STRING' '{' key_equals_value '}';
//  preamble -> '@PREAMBLE' '{' value '}';
//  comment -> '@COMMENT' '{' value '}';
//  entry -> '@' key '{' key ',' key_value_list '}';
//  key_value_list -> key_equals_value (',' key_equals_value)*;
//  key_equals_value -> key '=' value;
//  value -> value_quotes | value_braces | key;
//  value_quotes -> '"' .*? '"'; // not quite
//  value_braces -> '{' .*? '"'; // not quite
function BibtexParser() {
  this.pos = 0;
  this.input = "";
  
  this.entries = {};
  this.strings = {
      JAN: "January",
      FEB: "February",
      MAR: "March",      
      APR: "April",
      MAY: "May",
      JUN: "June",
      JUL: "July",
      AUG: "August",
      SEP: "September",
      OCT: "October",
      NOV: "November",
      DEC: "December"
  };
  this.currentKey = "";
  this.currentEntry = "";
  

  this.setInput = function(t) {
    this.input = t;
  }
  
  this.getEntries = function() {
      return this.entries;
  }

  this.isWhitespace = function(s) {
    return (s == ' ' || s == '\r' || s == '\t' || s == '\n');
  }

  this.match = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      this.pos += s.length;
    } else {
      throw "Token mismatch, expected " + s + ", found " + this.input.substring(this.pos);
    }
    this.skipWhitespace();
  }

  this.tryMatch = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      return true;
    } else {
      return false;
    }
    this.skipWhitespace();
  }

  this.skipWhitespace = function() {
    while (this.isWhitespace(this.input[this.pos])) {
      this.pos++;
    }
    if (this.input[this.pos] == "%") {
      while(this.input[this.pos] != "\n") {
        this.pos++;
      }
      this.skipWhitespace();
    }
  }

  this.value_braces = function() {
    var bracecount = 0;
    this.match("{");
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '}' && this.input[this.pos-1] != '\\') {
        if (bracecount > 0) {
          bracecount--;
        } else {
          var end = this.pos;
          this.match("}");
          return this.input.substring(start, end);
        }
      } else if (this.input[this.pos] == '{') {
        bracecount++;
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value";
      }
      this.pos++;
    }
  }

  this.value_quotes = function() {
    this.match('"');
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '"' && this.input[this.pos-1] != '\\') {
          var end = this.pos;
          this.match('"');
          return this.input.substring(start, end);
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value:" + this.input.substring(start);
      }
      this.pos++;
    }
  }
  
  this.single_value = function() {
    var start = this.pos;
    if (this.tryMatch("{")) {
      return this.value_braces();
    } else if (this.tryMatch('"')) {
      return this.value_quotes();
    } else {
      var k = this.key();
      if (this.strings[k.toUpperCase()]) {
        return this.strings[k];
      } else if (k.match("^[0-9]+$")) {
        return k;
      } else {
        throw "Value expected:" + this.input.substring(start);
      }
    }
  }
  
  this.value = function() {
    var values = [];
    values.push(this.single_value());
    while (this.tryMatch("#")) {
      this.match("#");
      values.push(this.single_value());
    }
    return values.join("");
  }

  this.key = function() {
    var start = this.pos;
    while(true) {
      if (this.pos == this.input.length) {
        throw "Runaway key";
      }
    
      if (this.input[this.pos].match("[a-zA-Z0-9_:\\./-]")) {
        this.pos++
      } else {
        return this.input.substring(start, this.pos).toUpperCase();
      }
    }
  }

  this.key_equals_value = function() {
    var key = this.key();
    if (this.tryMatch("=")) {
      this.match("=");
      var val = this.value();
      return [ key, val ];
    } else {
      throw "... = value expected, equals sign missing:" + this.input.substring(this.pos);
    }
  }

  this.key_value_list = function() {
    var kv = this.key_equals_value();
    this.entries[this.currentEntry][kv[0]] = kv[1];
    while (this.tryMatch(",")) {
      this.match(",");
      // fixes problems with commas at the end of a list
      if (this.tryMatch("}")) {
        break;
      }
      kv = this.key_equals_value();
      this.entries[this.currentEntry][kv[0]] = kv[1];
    }
  }

  this.entry_body = function() {
    this.currentEntry = this.key();
    this.entries[this.currentEntry] = new Object();    
    this.match(",");
    this.key_value_list();
  }

  this.directive = function () {
    this.match("@");
    return "@"+this.key();
  }

  this.string = function () {
    var kv = this.key_equals_value();
    this.strings[kv[0].toUpperCase()] = kv[1];
  }

  this.preamble = function() {
    this.value();
  }

  this.comment = function() {
    this.value(); // this is wrong
  }

  this.entry = function() {
    this.entry_body();
  }

  this.bibtex = function() {
    while(this.tryMatch("@")) {
      var d = this.directive().toUpperCase();
      this.match("{");
      if (d == "@STRING") {
        this.string();
      } else if (d == "@PREAMBLE") {
        this.preamble();
      } else if (d == "@COMMENT") {
        this.comment();
      } else {
        this.entry();
      }
      this.match("}");
    }
  }
}

function BibtexDisplay() {
  
  //Regex Searchs used by fixValue in proper order
  this.regExps = [];
  this.regExps.push(new RegExp("\{\\\\\\W*\\w+\}")); // 1 {\[]}
  this.regExps.push(new RegExp("\\\\\\W*\{\\w+\}")); // 2 \[]{\[]}
  this.regExps.push(new RegExp("\\\\\\W*\\w+\\s")); // 3 \[]
  this.regExps.push(new RegExp("\\\\\\W*\\w+")); // 4 \[]
  this.regExps.push(new RegExp("\\\\(?![:\\\\\])\\W{1}")); // 5
  
  this.fixValue = function (value) {
    do {
      var removeBrackets = value.match(/^\{(.*?)\}$/g, '$1');
      if(removeBrackets)
      {
        value = value.replace(/^\{(.*?)\}$/g, '$1');
      }
    }while(removeBrackets);
    
    // Working on a more efficient way of processing the latex
    var index = value.indexOf("\\");
    if(index > -1) {
      for(var exp in this.regExps) {
        do {
          var str = value.match(this.regExps[exp]);
          var key = (str)?str[0]:"";
          if(str) {
            if(typeof(latex_to_unicode[key]) != "undefined")
            {
              value = value.replace(key,latex_to_unicode[key]);
            } else {
              var newkey = key.replace(new RegExp("(\\w)"), '{$1}')
              if(typeof(latex_to_unicode[newkey]) != "undefined")
              {
                value = value.replace(key,latex_to_unicode[newkey]);
              } else {
                str = "";
              }
            }
          } else {
            str = "";
          }
        } while(str.length);
      }
    }
    value = value.replace(/[\{|\}]/g, '');
    return value;
  }
  
  this.displayBibtex2 = function(i, o) {
    var b = new BibtexParser();
    b.setInput(i);
    b.bibtex();

    var e = b.getEntries();
    var old = o.find("*");
  
    for (var item in e) {
      var tpl = $(".bibtex_template").clone().removeClass('bibtex_template');
      tpl.addClass("unused");
      
      for (var key in e[item]) {
      
        var fields = tpl.find("." + key.toLowerCase());
        for (var i = 0; i < fields.size(); i++) {
          var f = $(fields[i]);
          f.removeClass("unused");
          var value = this.fixValue(e[item][key]);
          if (f.is("a")) {
            f.attr("href", value);
          } else {
            var currentHTML = f.html() || "";
            if (currentHTML.match("%")) {
              // "complex" template field
              f.html(currentHTML.replace("%", value));
            } else {
              // simple field
              f.html(value);
            }
          }
        }
      }
    
      var emptyFields = tpl.find("span .unused");
      emptyFields.each(function (key,f) {
        if (f.innerHTML.match("%")) {
          f.innerHTML = "";
        }
      });
    
      o.append(tpl);
      tpl.show();
    }
    
    old.remove();
  }

function apaReformat(entry) {
  var retEntry = entry;
  if (entry.hasOwnProperty("AUTHOR")) {
    var perAuthor = entry.AUTHOR.split(" and ");
    var authStr = "";
    for (var i = 0; i < perAuthor.length; i++) {
      if ((i>1) && (i == (perAuthor.length-1))) {
        authStr += "& ";
      }
      var curAuth = perAuthor[i].split(".");
      authStr += curAuth[curAuth.length-1].trim();
      if (i < (perAuthor.length-1)) {
        authStr += ", ";
      }
      for (var j= 0; j < curAuth.length-1; j++) {
        authStr += curAuth[j].trim().charAt(0) + ".";
        if (j < (curAuth.length-2)) {
          authStr += " ";
        }

        if (i < (perAuthor.length-1)) {
          authStr += ", ";
        }
      }
    }
    retEntry.AUTHOR = authStr;
  }

  if (entry.hasOwnProperty("JOURNAL")) {
    retEntry.JOURNAL = entry.JOURNAL.replace("\\","")
  }

  if (entry.hasOwnProperty("PAGES")) {
    retEntry.PAGES = entry.PAGES.replace("--", "-")
  }
  return retEntry;
}
  this.displayBibtex = function(input, output, context) {
    // parse bibtex input
    var b = new BibtexParser();
    b.setInput(input);
    b.bibtex();

    // save old entries to remove them later
    var old = output.find("*");

    // iterate over bibTeX entries
    var entries = b.getEntries();
    //var entries = Object.keys(entriesObj);
    var year, lastYear;

    // sort by year
    var queue = new PriorityQueue({
      comparator: function (a, b) {
        if (isNaN(a.YEAR)) {
          return -1;
        }
        else if (isNaN(b.YEAR)) {
          return 1;
        }
        return parseInt(b.YEAR) - parseInt(a.YEAR);
      }
    });

    for (var entryKey in entries) {
      if (entries.hasOwnProperty(entryKey)) {
        queue.queue(entries[entryKey]);
      }
    }

    while (queue.length > 0) {
        var entry = queue.dequeue();
        //remap authors so that initials come first
        entry = apaReformat(entry);
        // find year
        lastYear = year;
        year = entry['YEAR'];
        // find template
        var tpl = $(".bibtex_template", context).clone().removeClass('bibtex_template');

        // find all keys in the entry
        var keys = [];
        for (var key in entry) {
          keys.push(key.toUpperCase());
        }

        // find all ifs and check them
        var removed = false;
        do {
          // find next if
          var conds = tpl.find(".if");
          if (conds.size() == 0) {
            break;
          }

          // check if
          var cond = conds.first();
          cond.removeClass("if");
          var ifTrue = true;
          var classList = cond.attr('class').split(' ');
          $.each(classList, function (index, cls) {
            if(cls[0]=="!" &&
               keys.indexOf(cls.substring(1,cls.length).toUpperCase()) < 0) {
            ifTrue = true;
            }
            else if(keys.indexOf(cls.toUpperCase()) < 0) {
              ifTrue = false;
            }
            cond.removeClass(cls);
          });

          // remove false ifs
          if (!ifTrue) {
            cond.remove();
          }
        } while (true);

        // fill in remaining fields
        for (var index in keys) {
          var key = keys[index];
          var value = entry[key] || "";
          // don't show year if it's not a number
//           if ( key == 'YEAR' && isNaN(value) ){
//             tpl.find("span:not(a)." + key.toLowerCase()).parent().remove();
//           } else {
            tpl.find("span:not(a)." + key.toLowerCase()).html(this.fixValue(value));
            tpl.find("a." + key.toLowerCase()).attr('href', this.fixValue(value));
//           }
        }
        
        // if year is different, add as header to new entry
        if (year != lastYear){
          tpl.prepend('<h2 class="auto-heading">'+year+'</h2>');
        }
        
        output.append(tpl);
        tpl.show();
      }

      // remove old entries
      old.remove();

    }

}

function bibtex_js_draw() {
  $(".bibtex_template").hide();
  // $("#bibtex_input").load("bib/labpapers.bib", function () {
  //   (new BibtexDisplay()).displayBibtex($("#bibtex_input").text(), $("#bibtex_display"));
  // })


    $(".block_id-166534").each(function(i){
        if (i === 0 ) {
        (new BibtexDisplay()).displayBibtex($(this).find(".bibtex_input").text(), $(this).find(".bibtex_display"), $(this));
        	
        };
 


    });


    // $(".block_type__bib-text").each(function(){
        
    //      (new BibtexDisplay()).displayBibtex($(this).find("#bibtex_input").text(), $(this).find("#bibtex_display"));


    // });

}



// check whether or not jquery is present
if (typeof jQuery == 'undefined') {  
  // an interesting idea is loading jquery here. this might be added
  // in the future.
  alert("Please include jquery in all pages using bibtex_js!");
} else {
  // draw bibtex when loaded
  $(document).ready(function () {
    // check for template, add default
    if ($(".bibtex_template").size() == 0) {
      $("body").append("<div class=\"bibtex_template\"><div class=\"if author\" style=\"font-weight: bold;\">\n  <span class=\"if year\">\n    <span class=\"year\"></span>, \n  </span>\n  <span class=\"author\"></span>\n  <span class=\"if url\" style=\"margin-left: 20px\">\n    <a class=\"url\" style=\"color:black; font-size:10px\">(view online)</a>\n  </span>\n</div>\n<div style=\"margin-left: 10px; margin-bottom:5px;\">\n  <span class=\"title\"></span>\n</div></div>");
    }

    bibtex_js_draw();
  });
}


});
</script>


	
	</div>


	<div class="block_container " data-content-id="166402"> 
  <div class="block__bg-img block_container__bg-img" style="display:none;"></div>
	
	

    <script type="text/javascript" src="javascripts/sdi/priority-queue.js"></script>
<script type="text/javascript" src="javascripts/sdi/latex-to-unicode.js"></script>
<!-- <script type="text/javascript" src="/javascripts/sdi/bibtex_js.js"></script> -->
<div id="166402" class="block block_id-166402 block_type__bib-text-auto-sort">
	<div class="page_frame">

			<div class="twelve-col center">
				<table id="pubTable" class="display"></table>
					<div class="bibtex_input" style="display:none;">

            @article{zepeda2024distinct,
              title={A distinct Fusobacterium nucleatum clade dominates the colorectal cancer niche},
              author={Martha Zepeda-Rivera and Samuel S Minot and Heather Bouzek and Hanrui Wu and Aitor Blanco-Míguez and Paolo Manghi and Dakota S Jones and Kaitlyn D LaCourse and Ying Wu and Elsa F McMahon and Soon-Nang Park and Yun K Lim and Andrew G Kempchinsky and Amy D Willis and Sean L Cotton and Susan C Yost and Ewa Sicinska and Joong-Ki Kook and Floyd E Dewhirst and Nicola Segata and Susan Bullman and Christopher D Johnston},
              journal={Nature},
              volume={628},
              number={8007},
              pages={424--432},
              year={2024},
              url = {https://www.nature.com/articles/s41586-024-07182-w}
            }


@article{kim2024host,
  title={Host DNA depletion on frozen human respiratory samples enables successful metagenomic sequencing for microbiome studies},
  author={Minsik Kim and Raymond C Parrish II and Viral S Shah and Matthew Ross and Juwan Cormier and Aribah Baig and Ching-Ying Huang and Laura Brenner and Isabel Neuringer and Katrine Whiteson and J Kirk Harris and Amy D Willis and and Peggy S Lai},
year ={2024},
journal = {Communications Biology},
url = {https://pubmed.ncbi.nlm.nih.gov/38343829/}
}

@article {Fogarty,
	author = {Emily C Fogarty and Matthew S Schechter and Karen Lolans and Madeline L. Sheahan and Iva Veseli and Ryan Moore and Evan Kiefl and Thomas Moody and Phoebe A Rice and Michael K Yu and Mark Mimee and Eugene B Chang and Sandra L Mclellan and Amy D Willis and Laurie E Comstock and A Murat Eren},
	title = {A highly conserved and globally prevalent cryptic plasmid is among the most numerous mobile genetic elements in the human gut},
	year = {2024},
  volume = {187},
  number = {5},
    pages = {1206--1222},
	URL = {https://www.cell.com/cell/fulltext/S0092-8674(24)00107-7},
	journal = {Cell}, 
}

            @article {hdw-mgx,
              author = {Pauline Trinh and Marilyn C Roberts and Peter M Rabinowitz and Amy D Willis},
              title = {A cross-sectional comparison of gut metagenomes between dairy workers and community controls},
              year = {2024},
              volume = {25},
              number = {708},
              URL = {https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-024-10562-1},
              journal = {BMC Genomics}, 
            }

            @article{teichman2023analyzing,
              title={Analyzing microbial evolution through gene and genome phylogenies},
              author={Sarah Teichman and Michael D Lee and Amy D Willis},
              journal={Biostatistics},
              volume = {25},
              number = {3},
              year={2024},
              url={https://academic.oup.com/biostatistics/article/25/3/786/7332152}
            }

@article{happi,
author = {Pauline Trinh and David S Clausen and Amy D Willis},
year ={2023},
title = {{happi: a Hierarchical Approach to Pangenomics Inference}},
journal = {Genome Biology},
volume = {24},
number = {214},
url = {https://genomebiology.biomedcentral.com/articles/10.1186/s13059-023-03040-6}
}

@article{kiefl,
author = {Evan Kiefl, Ozcan C Esen, Samuel E Miller, Kourtney L Kroll, Amy D Willis, Michael S Rapp{\&#x27;e}, Tao Pan and A Murat Eren},
year ={2023},
title = {{Structure-informed microbial population genetics elucidate selective pressures that shape protein evolution}},
journal = {Science Advances},
volume = {9},
number = {8},
pages={eabq4632},
url = {https://www.science.org/doi/10.1126/sciadv.abq4632}
}

@article{dryad,
	url = {https://datadryad.org/stash/dataset/doi:10.5061/dryad.m63xsj45z},
	year = {2023},
	journal = {{Dryad}},
	author = {Rui P A Pereira and John Bagnoli and Lisa Karstens and Kris Locken and Katherine A Maki and Hena Ramay and Adam Rivers and Stephanie Servetas and Kezia Valyi and Yan Wang and Meredith L Carpenter and Denise M O'Sullivan and Katrine Whiteson and Amy Willis},
	title = {Sources of microbial reference materials}
}

@article{Veseli,
	url = {https://elifesciences.org/reviewed-preprints/89862},
	year = {2024},
	journal = {{eLife}},
	author = {Iva Veseli and Yiqun T Chen and Matthew S Schechter and Chiara Vanni and Emily C Fogarty and Andrea R Watson and Bana Jabri and Ran Blekhman and Amy D Willis and Michael K Yu and Antonio Fern{\`{a}}ndez-Guerra and Jessika Füssel and A Murat Eren},
	title = {Microbes with higher metabolic independence are enriched in human gut microbiomes under stress}
}


@article{rigr,
doi = {10.21105/joss.04847},
url = {https://doi.org/10.21105/joss.04847},
year = {2022},
publisher = {The Open Journal},
volume = {7},
number = {80},
pages = {4847},
author = {Yiqun T Chen and Brian D Williamson and Taylor Okonek and Charles J Wolock and Andrew J Spieker and Travis Y Hee Wai and James P Hughes and Scott S Emerson and Amy D Willis},
title = {rigr: Regression, Inference, and General Data Analysis Tools in R},
journal = {Journal of Open Source Software}
}

@article{mbqc,
author = {David S Clausen and Amy D Willis},
year ={2022},
title = {{Evaluating replicability in microbiome data}},
journal = {Biostatistics},
url = {https://academic.oup.com/biostatistics/advance-article/doi/10.1093/biostatistics/kxab048/6490209}
}


@article{duygu,
author = {Emily Kuehn and David S Clausen and Ryan W Null and Bria M Metzger and Amy D Willis and B Duygu {\&quot;O}zpolat},
title = {{Segment number threshold determines juvenile onset of germline cluster proliferation in Platynereis dumerilii}},
journal = {Journal of Experimental Zoology Part B: Molecular and Developmental Evolution},
year = {2022},
volume = {338},
number = {4},
pages = {225-240},
url = {https://onlinelibrary.wiley.com/doi/10.1002/jez.b.23100}
}


@article{Kordahi2021,
	author = {Melissa Kordahi and Mariion Avril and Ian Stanaway and Denise Chac and B Ross and C Diener and Sumita Jain and P McCleary and Anika Parker and Vince Friedman and J Huang and Wynn Burke and Sean Gibbons and Amy D Willis and Richard Darveau and WM Grady and Cynthia Ko and R William DePaolo},
	title = {Genomic and Functional Characterization of a Mucosal Symbiont Involved in Early-Stage Colorectal Cancer},
	year = {2021},
	URL = {https://dx.doi.org/10.2139/ssrn.3821078},
	journal = {Cell Host and Microbe}
}


@article{Wooller806,
	author = {Matthew J Wooller and Clement Bataille and Patrick Druckenmiller and Gregory M Erickson and Pamela Groves and Norma Haubenstock and Timothy Howe and Johanna Irrgeher and Daniel Mann and Katherine Moon and Ben A Potter and Thomas Prohaska and Jeffrey Rasic and Joshua Reuther and Beth Shapiro and Karen J Spaleta and Amy D Willis},
	title = {Lifetime mobility of an Arctic woolly mammoth},
	volume = {373},
	number = {6556},
	pages = {806--808},
	year = {2021},
	doi = {10.1126/science.abg1134},
	publisher = {American Association for the Advancement of Science},
	URL = {https://science.sciencemag.org/content/373/6556/806},
	eprint = {https://science.sciencemag.org/content/373/6556/806.full.pdf},
	journal = {Science}
}

@article{eren2021community,
  title={Community-led, integrated, reproducible multi-omics with anvi&#x27;o},
  author={A Murat Eren and Evan Kiefl and Alon Shaiber and Iva Veseli and Samuel E Miller and Matthew S Schechter and Isaac Fink and Jessica N Pan and Mahmoud Yousef and Emily C Fogarty and Florian Trigodet and Andrea R Watson and {\&quot;O}zcan C Esen and Ryan M Moore and Quentin Clayssen and Michael D Lee and Veronika Kivenson and Elaina D Graham and Bryan D Merrill and Antti Karkman and Daniel Blankenberg and John M Eppley and Andreas Sj{\&quot;o}din and Jarrod J Scott and Xabier V\&#x27;{a}zquez-Campos and Luke J McKay and Elizabeth A McDaniel and Sarah L R Stevens and Rika E Anderson and Jessika Fuessel and Antonio Fernandez-Guerra and Lois Maignien and Tom O Delmont and Amy D Willis},
  journal={Nature Microbiology},
  volume={6},
  number={1},
  pages={3--6},
  year={2021},
  publisher={Nature Publishing Group},
	url={https://www.nature.com/articles/s41564-020-00834-3},
}

@article{Williamson2021,
author = {Brian D Williamson and James P Hughes and Amy D Willis},
title = {A multiview model for relative and absolute microbial abundances},
journal = {Biometrics},
url = {https://onlinelibrary.wiley.com/doi/abs/10.1111/biom.13503},
year={2021},
}

@article{minot2021geneshot,
  title={geneshot: gene-level metagenomics identifies genome islands associated with immunotherapy response},
  author={Samuel S Minot and Kevin C Barry and Caroline Kasman and Jonathan L Golob and Amy D Willis},
  journal={Genome Biology},
  volume={22},
  number={1},
  pages={1--10},
  year={2021},
  publisher={Springer},
	url={https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02355-6},
}

@article{Martin:2019wj,
author = {Bryan D Martin and Daniela Witten and Amy D Willis},
title = {{Modeling microbial abundances and dysbiosis with beta-binomial regression}},
volume = {14},
journal = {The Annals of Applied Statistics},
number = {1},
publisher = {Institute of Mathematical Statistics},
pages = {94 -- 115},
year = {2020},
doi = {10.1214/19-AOAS1283},
URL = {https://doi.org/10.1214/19-AOAS1283}
}

@article{Feng2021,
author = {Jean Feng and William S DeWitt III and Aaron McKenna and Noah Simon and Amy D Willis and Frederick A Matsen IV},
title = {{Estimation of cell lineage trees by maximum-likelihood phylogenetics}},
volume = {15},
journal = {The Annals of Applied Statistics},
number = {1},
publisher = {Institute of Mathematical Statistics},
pages = {343 -- 362},
year = {2021},
doi = {10.1214/20-AOAS1400},
URL = {https://doi.org/10.1214/20-AOAS1400}
}


@article{Shaiber2020,
	author = {Alon Shaiber and Amy D Willis and Tom O Delmont and Simon Roux and Lin-Xing Chen and Abigail C Schmid and Mahmoud Yousef and Andrea R Watson and Karen Lolans and {\&quot;O}zcan C Esen and Sonny T M Lee and Nora Downey and Hilary G Morrison and Floyd E Dewhirst and Jessica L Mark Welch and A Murat Eren},
	title = {{Functional and genetic markers of niche partitioning among enigmatic members of the human oral microbiome}},
  year ={2020},
  journal = {Genome Biology},
	volume = {21},
	number = {292},
	url = {https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02195-w},
}

@article{Paynter:rre,
author = {Alex Paynter and Amy D Willis},
title = {Tuning parameter selection for a penalized estimator of species richness},
journal = {Journal of Applied Statistics},
volume = {48},
number = {6},
pages = {1053-1070},
year  = {2021},
publisher = {Taylor &amp; Francis},
doi = {10.1080/02664763.2020.1754359},
URL = {https://doi.org/10.1080/02664763.2020.1754359}
}

@article{Willis:divnet,
author = {Amy D Willis and Bryan D Martin},
year ={2020},
title = {{DivNet: Estimating diversity in networked communities}},
journal = {Biostatistics},
volume = {kxaa015},
url = {https://academic.oup.com/biostatistics/advance-article-abstract/doi/10.1093/biostatistics/kxaa015/5841114},
}

@article{WillisMinot2020trends,
author = {Amy D Willis and Samuel S Minot},
title = {{Strategies to Facilitate Translational Advances from Microbiome Surveys}},
url = {https://www.sciencedirect.com/science/article/pii/S0966842X20300263#!},
journal={Trends in Microbiology},
year={2020},
}


@article{Willis:2017tk,
author = {Amy D Willis},
title = {{Rarefaction, alpha diversity, and statistics}},
url = {https://www.frontiersin.org/articles/10.3389/fmicb.2019.02407/full},
journal={Frontiers in Microbiology},
volume={10},
pages={2407},
year={2019},
}


@article{McLaren:2019cn,
author = {Michael R McLaren and Amy D Willis and Benjamin J Callahan},
journal = {eLife},
title = {{Consistent and correctable bias in metagenomic sequencing measurements}},
year = {2019},
volume = {8},
url={https://elifesciences.org/articles/46923},
}

@article{Sarfaty,
author = {Anna E Sarfaty and Caroline J Zeiss and Amy D Willis and Jorgen M Harris and Peter C Smith},
journal = {Journal of the American Association of Laboratory Animal Science},
title = {{Concentration dependent toxicity following subcutaneous meloxicam administration in C57Bl/6N Mice}},
year = {2019},
volume = {58},
number = {6},
pages = {802--809},
url = {https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6926403/},
}


@article{Minot:2019hc,
author = {Samuel S Minot and Amy D Willis},
doi = {10.1186/s40168-019-0722-6},
journal = {Microbiome},
number = {110},
title = {{Clustering co-abundant genes identifies components of the gut microbiome that are reproducibly associated with colorectal cancer and inflammatory bowel disease}},
volume = {7},
year = {2019},
url={https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0722-6}
}

@article{q2,
author = {Evan Bolyen and Jai Ram Rideout and Matthew R Dillon and Nicholas A Bokulich and Christian C Abnet and Gabriel A Al-Ghalith and Harriet Alexander and Eric J Alm and Manimozhiyan Arumugam and Francesco Asnicar and Yang Bai and Jordan E Bisanz and Kyle Bittinger and Asker Brejnrod and Colin J Brislawn and C Titus Brown and Benjamin J Callahan and Andr{\&#x27;e}s Mauricio Caraballo-Rodr{\&#x27;i}guez and John Chase and Emily K Cope and Ricardo Da Silva and Christian Diener and Pieter C Dorrestein and Gavin M Douglas and Daniel M Durall and Claire Duvallet and Christian F Edwardson and Madeleine Ernst and Mehrbod Estaki and Jennifer Fouquier and Julia M Gauglitz and Sean M Gibbons and Deanna L Gibson and Antonio Gonzalez and Kestrel Gorlick and Jiarong Guo and Benjamin Hillmann and Susan Holmes and Hannes Holste and Curtis Huttenhower and Gavin A Huttley and Stefan Janssen and Alan K Jarmusch and Lingjing Jiang and Benjamin D Kaehler and Kyo Bin Kang and Christopher R Keefe and Paul Keim and Scott T Kelley and Dan Knights and Irina Koester and Tomasz Kosciolek and Jorden Kreps and Morgan G I Langille and Joslynn Lee and Ruth Ley and Yong-Xin Liu and Erikka Loftfield and Catherine Lozupone and Massoud Maher and Clarisse Marotz and Bryan D Martin and Daniel McDonald and Lauren J McIver and Alexey V Melnik and Jessica L Metcalf and Sydney C Morgan and Jamie T Morton and Ahmad Turan Naimey and Jose A Navas-Molina and Louis Felix Nothias and Stephanie B Orchanian and Talima Pearson and Samuel L Peoples and Daniel Petras and Mary Lai Preuss and Elmar Pruesse and Lasse Buur Rasmussen and Adam Rivers and Michael S Robeson II and Patrick Rosenthal and Nicola Segata and Michael Shaffer and Arron Shiffer and Rashmi Sinha and Se Jin Song and John R Spear and Austin D Swafford and Luke R Thompson and Pedro J Torres and Pauline Trinh and Anupriya Tripathi and Peter J Turnbaugh and Sabah Ul-Hasan and Justin J J van der Hooft and Fernando Vargas and Yoshiki V{\&#x27;a}zquez-Baeza and Emily Vogtmann and Max von Hippel and William Walters and Yunhu Wan and Mingxun Wang and Jonathan Warren and Kyle C Weber and Charles H D Williamson and Amy D Willis and Zhenjiang Zech Xu and Jesse R Zaneveld and Yilong Zhang and Qiyun Zhu and Rob Knight and J Gregory Caporaso},
title = {{Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2}},
issn = {1546-1696},
journal = {Nature Biotechnology},
number = {8},
pages = {852--857},
url = {https://doi.org/10.1038/s41587-019-0209-9},
volume = {37},
year = {2019}
}

@article {Willise00117-19,
	author = {Amy D Willis},
	title = {Rigorous Statistical Methods for Rigorous Microbiome Science},
	volume = {4},
	number = {3},
	elocation-id = {e00117-19},
	year = {2019},
	doi = {10.1128/mSystems.00117-19},
	publisher = {American Society for Microbiology Journals},
	URL = {https://msystems.asm.org/content/4/3/e00117-19},
	eprint = {https://msystems.asm.org/content/4/3/e00117-19.full.pdf},
	journal = {mSystems}
}


@article{Willis:2017tw,
author = {Amy Willis},
title = {Confidence Sets for Phylogenetic Trees},
journal = {Journal of the American Statistical Association},
volume = {114},
number = {525},
pages = {235-244},
year  = {2019},
publisher = {Taylor &amp; Francis},
url = {https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1395342},
}


@article{Willis:2017wi,
author = {Amy D Willis and Rayna C Bell},
title = {{Uncertainty in phylogenetic tree estimates}},
journal = {Journal of Computational and Graphical Statistics},
volume = {27},
number = {3},
pages = {542-552},
year  = {2018},
publisher = {Taylor &amp; Francis},
url = {https://www.tandfonline.com/doi/full/10.1080/10618600.2017.1391697},
}

@article{Tromas:2017dk,
author = {Nicolas Tromas and Zofia E Taranu and Bryan D Martin and Amy Willis and Nathalie Fortin and Charles W Greer and B Jesse Shapiro},
title = {{Niche Separation Increases With Genetic Distance Among Bloom-Forming Cyanobacteria}},
journal = {Frontiers in Microbiology},
year = {2018},
volume = {9},
pages = {109},
url = {https://www.frontiersin.org/articles/10.3389/fmicb.2018.00438/full},
}



@article{Bataille:2017vs,
author = {Cl{\&#x27;e}ment P Bataille and Amy Willis and Xiao Yang and Xiao-Ming Liu},
title = {{Continental igneous rock composition: A major control of past global chemical weathering}},
journal = {Science Advances},
year = {2017},
volume = {3},
number = {3},
pages = {e1602183},
url = {https://advances.sciencemag.org/content/3/3/e1602183},
}

@article{Chan:2017wa,
author = {Nancy Chan and Amy Willis and Naomi Kornhauser and Maureen M Ward and Sharrell B Lee and Eleni Nackos and Bo Ri Seo and Ellen Chuang and Tessa Cigler and Anne Moore and Diana Donovan and Marta Vallee Cobham and Veronica Fitzpatrick and Sarah Schneider and Alysia Wiener and Jessica Guillaume-Abraham and Elnaz Aljom and Richard Zelkowitz and J David Warren and Maureen E Lane and Claudia Fischbach and Vivek Mittal and Linda Vahdat},
title = {{Influencing the Tumor Microenvironment: A Phase II Study of Copper Depletion Using Tetrathiomolybdate in Patients with Breast Cancer at High Risk for Recurrence and in Preclinical Models of Lung Metastases}},
journal = {Clinical Cancer Research},
year = {2017},
volume = {23},
number = {3},
pages = {666--676},
url = {https://clincancerres.aacrjournals.org/content/23/3/666.long},
}


@article{Sahota:2017dy,
author = {Sheena Sahota and Naomi Kornhauser and Amy Willis and Maureen M Ward and Tessa Cigler and Anne Moore and Eleni Andreopoulou and Veronica Fitzpatrick and Sarah E Schneider and Alysia Wiener and Anna Rubinchik and Sharrell Lee and Maureen E Lane and Vivek Mittal and Linda T Vahdat},
title = {{A phase II study of copper-depletion using tetrathiomolybdate (TM) in patients (pts) with breast cancer (BC) at high risk for recurrence: Updated results}},
journal = {Journal of Clinical Oncology},
year = {2017},
volume = {35},
number = {15},
pages = {2557--2557},
url = {https://cancerres.aacrjournals.org/content/78/4_Supplement/P1-10-02},
}


@article{Samorodnitsky:2016tt,
author = {Gennady Samorodnitsky and Sidney Resnick and Don Towsley and Richard Davis and Amy Willis and Phyllis Wan},
title = {{Nonstandard regular variation of in-degree and out-degree in the preferential attachment model}},
journal = {Journal of Applied Probability},
year = {2016},
volume = {53},
number = {1},
pages = {146--161},
url = {https://projecteuclid.org/euclid.jap/1457470565},
}


@article{Willis:2016wj,
author = {Amy D Willis and John Bunge and Thea Whitman},
title = {{Improved detection of changes in species richness in high-diversity microbial communities}},
journal = {Journal of the Royal Statistical Society: Series C (Applied Statistics)},
year = {2016},
volume = {66},
number = {5},
pages = {963--977},
url={https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssc.12206},
}

@article{Willis:2016te,
author = {Amy D Willis},
title = {{Extrapolating abundance curves has no predictive power for estimating microbial biodiversity}},
journal = {Proceedings of the National Academy of Sciences},
year = {2016},
volume = {113},
number = {35},
pages = {E5096--E5096},
url = {https://www.pnas.org/content/113/35/E5096},
}

@article{Brink:2016tl,
author = {Heidi Vanden Brink and Amy D Willis and Brittany Y Jarrett and Annie W Lin and Steven Soler and Si{\^a}n Best and Erica L Bender and Andrew K Peppin and Kathleen M Hoeger and Marla E Lujan},
title = {{Sonographic markers of ovarian morphology, but not hirsutism indices, predict serum total testosterone in women with regular menstrual cycles}},
journal = {Fertility and sterility},
year = {2016},
volume = {105},
number = {5},
pages = {1322--1329},
url = {https://www.sciencedirect.com/science/article/pii/S0015028216000029?via%3Dihub},
}



@article{Willis:2015vr,
author = {Amy D Willis and John Bunge},
title = {{Estimating diversity via frequency ratios}},
journal = {Biometrics},
year = {2015},
volume = {71},
number = {4},
pages = {1042--1049},
url={https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12332},
}

@article{RoyChoudhury:2015uv,
author = {Arindam RoyChoudhury and Amy Willis and John Bunge},
title = {{Consistency of a phylogenetic tree maximum likelihood estimator}},
journal = {Journal of Statistical Planning and Inference},
year = {2015},
volume = {161},
pages = {73--80},
url = {https://www.sciencedirect.com/science/article/pii/S0378375815000038}
}


@article{Bunge:2014tc,
author = {John Bunge and Amy Willis and Fiona Walsh},
title = {{Estimating the Number of Species in Microbial Diversity Studies}},
journal = {Annual Review of Statistics and Its Application},
year = {2014},
volume = {1},
number = {1},
pages = {427--445},
url={https://www.annualreviews.org/doi/full/10.1146/annurev-statistics-022513-115654}
}



@article{Christ:2014ux,
author = {Jacob P Christ and Amy D Willis and Eric D Brooks and Heidi Vanden Brink and Brittany Y Jarrett and Roger A Pierson and Donna R Chizen and Marla E Lujan},
title = {{Follicle number, not assessments of the ovarian stroma, represents the best ultrasonographic marker of polycystic ovary syndrome}},
journal = {Fertility and sterility},
year = {2014},
volume = {101},
number = {1},
pages = {280--287},
url = {https://www.fertstert.org/article/S0015-0282(13)03118-X/fulltext}
}
</div>


				<!-- The references will be populated in "bibtex_display" !-->
<div class="bibtex_display">   
</div>
<div class="bibtex_template">
	<div class ="well">
		<div class ="container">
			<div class="if author" style="font-weight: bold;">
				<span class="author"></span>
			</div>

			<!-- This div is what is used to determine what is displayed from the bib entry. It is written to produce (roughly) APA formatting, though it is not perfect... !-->
			<div style="margin-left: 10px; margin-bottom:5px;">
				<span class="if url">
          <a class="url "><span class="title "></span></a>.
				</span>
				<span class="if !url">
          <span class="title "></span>.
				</span>
				<span class="if editor ">
					In <span class="editor "></span> (Eds.),
				</span>
				<span class="if booktitle ">
					<span class="booktitle " style="font-style: italic;"></span>
					<span class="if pages ">
						(p. <span class="pages "></span>).
					</span>
					<span class="if address "><span class="address "></span>:</span>
					<span class="if publisher "><span class="publisher "></span>.</span>
				</span>
				<span class="if journal " style="font-style: italic;">
					<span class="journal"></span>,
				</span>
				<span class="if volume " style="font-style: italic;">
					<span class="volume"></span>
				</span>
				<span class="if number ">
					(<span class="number "></span>),
				</span>
				<span class="if journal ">
					<span class="if pages ">
						<span class="pages "></span>.
					</span>
				</span>
			</div>

		</div>
	</div>
</div>
					
			</div>




 
	</div>
</div>

<script type="text/javascript">
$(document).ready(function() {
// Issues:
//  no comment handling within strings
//  no string concatenation
//  no variable values yet

// Grammar implemented here:
//  bibtex -> (string | preamble | comment | entry)*;
//  string -> '@STRING' '{' key_equals_value '}';
//  preamble -> '@PREAMBLE' '{' value '}';
//  comment -> '@COMMENT' '{' value '}';
//  entry -> '@' key '{' key ',' key_value_list '}';
//  key_value_list -> key_equals_value (',' key_equals_value)*;
//  key_equals_value -> key '=' value;
//  value -> value_quotes | value_braces | key;
//  value_quotes -> '"' .*? '"'; // not quite
//  value_braces -> '{' .*? '"'; // not quite
function BibtexParser() {
  this.pos = 0;
  this.input = "";
  
  this.entries = {};
  this.strings = {
      JAN: "January",
      FEB: "February",
      MAR: "March",      
      APR: "April",
      MAY: "May",
      JUN: "June",
      JUL: "July",
      AUG: "August",
      SEP: "September",
      OCT: "October",
      NOV: "November",
      DEC: "December"
  };
  this.currentKey = "";
  this.currentEntry = "";
  

  this.setInput = function(t) {
    this.input = t;
  }
  
  this.getEntries = function() {
      return this.entries;
  }

  this.isWhitespace = function(s) {
    return (s == ' ' || s == '\r' || s == '\t' || s == '\n');
  }

  this.match = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      this.pos += s.length;
    } else {
      throw "Token mismatch, expected " + s + ", found " + this.input.substring(this.pos);
    }
    this.skipWhitespace();
  }

  this.tryMatch = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      return true;
    } else {
      return false;
    }
    this.skipWhitespace();
  }

  this.skipWhitespace = function() {
    while (this.isWhitespace(this.input[this.pos])) {
      this.pos++;
    }
    if (this.input[this.pos] == "%") {
      while(this.input[this.pos] != "\n") {
        this.pos++;
      }
      this.skipWhitespace();
    }
  }

  this.value_braces = function() {
    var bracecount = 0;
    this.match("{");
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '}' && this.input[this.pos-1] != '\\') {
        if (bracecount > 0) {
          bracecount--;
        } else {
          var end = this.pos;
          this.match("}");
          return this.input.substring(start, end);
        }
      } else if (this.input[this.pos] == '{') {
        bracecount++;
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value";
      }
      this.pos++;
    }
  }

  this.value_quotes = function() {
    this.match('"');
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '"' && this.input[this.pos-1] != '\\') {
          var end = this.pos;
          this.match('"');
          return this.input.substring(start, end);
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value:" + this.input.substring(start);
      }
      this.pos++;
    }
  }
  
  this.single_value = function() {
    var start = this.pos;
    if (this.tryMatch("{")) {
      return this.value_braces();
    } else if (this.tryMatch('"')) {
      return this.value_quotes();
    } else {
      var k = this.key();
      if (this.strings[k.toUpperCase()]) {
        return this.strings[k];
      } else if (k.match("^[0-9]+$")) {
        return k;
      } else {
        throw "Value expected:" + this.input.substring(start);
      }
    }
  }
  
  this.value = function() {
    var values = [];
    values.push(this.single_value());
    while (this.tryMatch("#")) {
      this.match("#");
      values.push(this.single_value());
    }
    return values.join("");
  }

  this.key = function() {
    var start = this.pos;
    while(true) {
      if (this.pos == this.input.length) {
        throw "Runaway key";
      }
    
      if (this.input[this.pos].match("[a-zA-Z0-9_:\\./-]")) {
        this.pos++
      } else {
        return this.input.substring(start, this.pos).toUpperCase();
      }
    }
  }

  this.key_equals_value = function() {
    var key = this.key();
    if (this.tryMatch("=")) {
      this.match("=");
      var val = this.value();
      return [ key, val ];
    } else {
      throw "... = value expected, equals sign missing:" + this.input.substring(this.pos);
    }
  }

  this.key_value_list = function() {
    var kv = this.key_equals_value();
    this.entries[this.currentEntry][kv[0]] = kv[1];
    while (this.tryMatch(",")) {
      this.match(",");
      // fixes problems with commas at the end of a list
      if (this.tryMatch("}")) {
        break;
      }
      kv = this.key_equals_value();
      this.entries[this.currentEntry][kv[0]] = kv[1];
    }
  }

  this.entry_body = function() {
    this.currentEntry = this.key();
    this.entries[this.currentEntry] = new Object();    
    this.match(",");
    this.key_value_list();
  }

  this.directive = function () {
    this.match("@");
    return "@"+this.key();
  }

  this.string = function () {
    var kv = this.key_equals_value();
    this.strings[kv[0].toUpperCase()] = kv[1];
  }

  this.preamble = function() {
    this.value();
  }

  this.comment = function() {
    this.value(); // this is wrong
  }

  this.entry = function() {
    this.entry_body();
  }

  this.bibtex = function() {
    while(this.tryMatch("@")) {
      var d = this.directive().toUpperCase();
      this.match("{");
      if (d == "@STRING") {
        this.string();
      } else if (d == "@PREAMBLE") {
        this.preamble();
      } else if (d == "@COMMENT") {
        this.comment();
      } else {
        this.entry();
      }
      this.match("}");
    }
  }
}

function BibtexDisplay() {
  
  //Regex Searchs used by fixValue in proper order
  this.regExps = [];
  this.regExps.push(new RegExp("\{\\\\\\W*\\w+\}")); // 1 {\[]}
  this.regExps.push(new RegExp("\\\\\\W*\{\\w+\}")); // 2 \[]{\[]}
  this.regExps.push(new RegExp("\\\\\\W*\\w+\\s")); // 3 \[]
  this.regExps.push(new RegExp("\\\\\\W*\\w+")); // 4 \[]
  this.regExps.push(new RegExp("\\\\(?![:\\\\\])\\W{1}")); // 5
  
  this.fixValue = function (value) {
    do {
      var removeBrackets = value.match(/^\{(.*?)\}$/g, '$1');
      if(removeBrackets)
      {
        value = value.replace(/^\{(.*?)\}$/g, '$1');
      }
    }while(removeBrackets);
    
    // Working on a more efficient way of processing the latex
    var index = value.indexOf("\\");
    if(index > -1) {
      for(var exp in this.regExps) {
        do {
          var str = value.match(this.regExps[exp]);
          var key = (str)?str[0]:"";
          if(str) {
            if(typeof(latex_to_unicode[key]) != "undefined")
            {
              value = value.replace(key,latex_to_unicode[key]);
            } else {
              var newkey = key.replace(new RegExp("(\\w)"), '{$1}')
              if(typeof(latex_to_unicode[newkey]) != "undefined")
              {
                value = value.replace(key,latex_to_unicode[newkey]);
              } else {
                str = "";
              }
            }
          } else {
            str = "";
          }
        } while(str.length);
      }
    }
    value = value.replace(/[\{|\}]/g, '');
    return value;
  }
  
  this.displayBibtex2 = function(i, o) {
    var b = new BibtexParser();
    b.setInput(i);
    b.bibtex();

    var e = b.getEntries();
    var old = o.find("*");
  
    for (var item in e) {
      var tpl = $(".bibtex_template").clone().removeClass('bibtex_template');
      tpl.addClass("unused");
      
      for (var key in e[item]) {
      
        var fields = tpl.find("." + key.toLowerCase());
        for (var i = 0; i < fields.size(); i++) {
          var f = $(fields[i]);
          f.removeClass("unused");
          var value = this.fixValue(e[item][key]);
          if (f.is("a")) {
            f.attr("href", value);
          } else {
            var currentHTML = f.html() || "";
            if (currentHTML.match("%")) {
              // "complex" template field
              f.html(currentHTML.replace("%", value));
            } else {
              // simple field
              f.html(value);
            }
          }
        }
      }
    
      var emptyFields = tpl.find("span .unused");
      emptyFields.each(function (key,f) {
        if (f.innerHTML.match("%")) {
          f.innerHTML = "";
        }
      });
    
      o.append(tpl);
      tpl.show();
    }
    
    old.remove();
  }

function apaReformat(entry) {
  var retEntry = entry;
  if (entry.hasOwnProperty("AUTHOR")) {
    var perAuthor = entry.AUTHOR.split(" and ");
    var authStr = "";
    for (var i = 0; i < perAuthor.length; i++) {
      if ((i>1) && (i == (perAuthor.length-1))) {
        authStr += "& ";
      }
      var curAuth = perAuthor[i].split(".");
      authStr += curAuth[curAuth.length-1].trim();
      if (i < (perAuthor.length-1)) {
        authStr += ", ";
      }
      for (var j= 0; j < curAuth.length-1; j++) {
        authStr += curAuth[j].trim().charAt(0) + ".";
        if (j < (curAuth.length-2)) {
          authStr += " ";
        }

        if (i < (perAuthor.length-1)) {
          authStr += ", ";
        }
      }
    }
    retEntry.AUTHOR = authStr;
  }

  if (entry.hasOwnProperty("JOURNAL")) {
    retEntry.JOURNAL = entry.JOURNAL.replace("\\","")
  }

  if (entry.hasOwnProperty("PAGES")) {
    retEntry.PAGES = entry.PAGES.replace("--", "-")
  }
  return retEntry;
}
  this.displayBibtex = function(input, output, context) {
    // parse bibtex input
    var b = new BibtexParser();
    b.setInput(input);
    b.bibtex();

    // save old entries to remove them later
    var old = output.find("*");

    // iterate over bibTeX entries
    var entries = b.getEntries();
    //var entries = Object.keys(entriesObj);
    var year, lastYear;

    // sort by year
    var queue = new PriorityQueue({
      comparator: function (a, b) {
        if (isNaN(a.YEAR)) {
          return -1;
        }
        else if (isNaN(b.YEAR)) {
          return 1;
        }
        return parseInt(b.YEAR) - parseInt(a.YEAR);
      }
    });

    for (var entryKey in entries) {
      if (entries.hasOwnProperty(entryKey)) {
        queue.queue(entries[entryKey]);
      }
    }

    while (queue.length > 0) {
        var entry = queue.dequeue();
        //remap authors so that initials come first
        entry = apaReformat(entry);
        // find year
        lastYear = year;
        year = entry['YEAR'];
        // find template
        var tpl = $(".bibtex_template", context).clone().removeClass('bibtex_template');

        // find all keys in the entry
        var keys = [];
        for (var key in entry) {
          keys.push(key.toUpperCase());
        }

        // find all ifs and check them
        var removed = false;
        do {
          // find next if
          var conds = tpl.find(".if");
          if (conds.size() == 0) {
            break;
          }

          // check if
          var cond = conds.first();
          cond.removeClass("if");
          var ifTrue = true;
          var classList = cond.attr('class').split(' ');
          $.each(classList, function (index, cls) {
            if(cls[0]=="!" &&
               keys.indexOf(cls.substring(1,cls.length).toUpperCase()) < 0) {
            ifTrue = true;
            }
            else if(keys.indexOf(cls.toUpperCase()) < 0) {
              ifTrue = false;
            }
            cond.removeClass(cls);
          });

          // remove false ifs
          if (!ifTrue) {
            cond.remove();
          }
        } while (true);

        // fill in remaining fields
        for (var index in keys) {
          var key = keys[index];
          var value = entry[key] || "";
          // don't show year if it's not a number
//           if ( key == 'YEAR' && isNaN(value) ){
//             tpl.find("span:not(a)." + key.toLowerCase()).parent().remove();
//           } else {
            tpl.find("span:not(a)." + key.toLowerCase()).html(this.fixValue(value));
            tpl.find("a." + key.toLowerCase()).attr('href', this.fixValue(value));
//           }
        }
        
        // if year is different, add as header to new entry
        if (year != lastYear){
          tpl.prepend('<h2 class="auto-heading">'+year+'</h2>');
        }
        
        output.append(tpl);
        tpl.show();
      }

      // remove old entries
      old.remove();

    }

}

function bibtex_js_draw() {
  $(".bibtex_template").hide();
  // $("#bibtex_input").load("bib/labpapers.bib", function () {
  //   (new BibtexDisplay()).displayBibtex($("#bibtex_input").text(), $("#bibtex_display"));
  // })


    $(".block_id-166402").each(function(i){
        if (i === 0 ) {
        (new BibtexDisplay()).displayBibtex($(this).find(".bibtex_input").text(), $(this).find(".bibtex_display"), $(this));
        	
        };
 


    });


    // $(".block_type__bib-text").each(function(){
        
    //      (new BibtexDisplay()).displayBibtex($(this).find("#bibtex_input").text(), $(this).find("#bibtex_display"));


    // });

}



// check whether or not jquery is present
if (typeof jQuery == 'undefined') {  
  // an interesting idea is loading jquery here. this might be added
  // in the future.
  alert("Please include jquery in all pages using bibtex_js!");
} else {
  // draw bibtex when loaded
  $(document).ready(function () {
    // check for template, add default
    if ($(".bibtex_template").size() == 0) {
      $("body").append("<div class=\"bibtex_template\"><div class=\"if author\" style=\"font-weight: bold;\">\n  <span class=\"if year\">\n    <span class=\"year\"></span>, \n  </span>\n  <span class=\"author\"></span>\n  <span class=\"if url\" style=\"margin-left: 20px\">\n    <a class=\"url\" style=\"color:black; font-size:10px\">(view online)</a>\n  </span>\n</div>\n<div style=\"margin-left: 10px; margin-bottom:5px;\">\n  <span class=\"title\"></span>\n</div></div>");
    }

    bibtex_js_draw();
  });
}


});
</script>


	
	</div>


</div>


  


	
  <div id="topfoot" class="userBG" style="background-image:url('https://s3.amazonaws.com/hoth.bizango/images/362955/footerbg_feature.jpg')">
    <img src="images/sites/sdi/lucyintheskywith.png" class="dia">
    <div class="page_frame group">
      <a href="index.html" class="footlog"><img src="images/sites/sdi/logo.png"></a>
      


      <div class="fl">
        <div class="links">
          <a id="" rel="publications"  href="publications.html">publications</a>
          <a id="" rel="team"  href="team.html">team</a>
          <a id="" rel="software"  href="software.html">software</a>
          <a id="" rel="teaching"  href="teaching.html">teaching</a>
          <a id="" rel="blog"  href="blog.html">blog</a>
          <a id="" rel="overview"  href="overview.html">research overview</a>
          <div class="rule"></div>
        </div>

       
        <div class="utes">
          <a href="https://twitter.com/AmyDWillis" target="_BLANK" class="twitt"><span class="icon-twitter"></span></a>
          <a href="https://github.com/adw96" target="_BLANK" class="git"><span class="icon-github"></span></a>
          <img src="images/sites/sdi/footeremail.png" class="this">

          
          <a href="tel:206.543.8027"><span class="icon-phone"></span>206.543.8027</a>

          <span class="loc"><span class="icon-location fl"></span>
            	<div class="bizango_cms bizango_cms_content bizango_content_prose textdiv_prose" id="content_151418_prose" data-bizango='{"monkey":"data", "field":"prose", "object_type":"content", "cms_id":"151418", "label":"" ,  "tag":"div"}' >	
		<p>Department of Biostatistics<br />
F-657, Box 357232<br />
Health Sciences Building, 1959 NE Pacific St<br />
University of Washington, Seattle, WA 98195</p>
		
	</div>
	






          </span>
          

        </div>
      </div>
  </div>

  <div id="footer">
  <div class="page_frame tAc">
    &copy; 2023 statistical diversity lab
  </div>
</div>
</div>



<div id="bottom_foot">
   <div class="page_frame tAc"> 
    <a id="bizango" href="https://www.bizango.com"  title="Website Design" target=_NEW>Website Design</a>
  </div>
</div>    

<script type="text/javascript">
$(document).ready(function() {

    $("#mobile_nav .nav").hide();
	$("#mobile_nav").click(function() {
		$("#mobile_nav .nav").toggle();
	});
	$("#nav_publications").addClass("current")

});
</script>



</body>
</html>
